<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataFlow - FastAPI Data Science Platform</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
</head>
<body>
    <!-- Background Animation -->
    <div class="bg-gradient"></div>
    <div class="grid-overlay"></div>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <svg class="logo-icon" viewBox="0 0 40 40" fill="none">
                    <path d="M20 5L35 15V25L20 35L5 25V15L20 5Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
                    <circle cx="20" cy="20" r="6" fill="currentColor"/>
                </svg>
                <span class="brand-text">DataFlow</span>
                <span class="version-badge">v1.0</span>
            </div>
            <div class="nav-status">
                <div class="status-indicator">
                    <span class="status-dot"></span>
                    <span class="status-text">API: <span id="api-status">Vérification...</span></span>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-content">
            <h1 class="hero-title">
                <span class="title-line">Plateforme Data Science</span>
                <span class="title-highlight">Complète & Interactive</span>
            </h1>
            <p class="hero-description">
                Du nettoyage de données au Machine Learning avancé,<br>
                explorez 5 phases d'un projet data en quelques clics.
            </p>
            <div class="hero-stats">
                <div class="stat-item">
                    <div class="stat-value">22</div>
                    <div class="stat-label">Endpoints API</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">5</div>
                    <div class="stat-label">Phases Complètes</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">∞</div>
                    <div class="stat-label">Possibilités</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Workflow Tabs -->
    <div class="workflow-container">
        <div class="tabs-container">
            <button class="tab-btn active" data-tab="tp1">
                <span class="tab-number">01</span>
                <span class="tab-name">Clean</span>
            </button>
            <button class="tab-btn" data-tab="tp2">
                <span class="tab-number">02</span>
                <span class="tab-name">EDA</span>
            </button>
            <button class="tab-btn" data-tab="tp3">
                <span class="tab-number">03</span>
                <span class="tab-name">Multivarié</span>
            </button>
            <button class="tab-btn" data-tab="tp4">
                <span class="tab-number">04</span>
                <span class="tab-name">ML Baseline</span>
            </button>
            <button class="tab-btn" data-tab="tp5">
                <span class="tab-number">05</span>
                <span class="tab-name">ML Avancé</span>
            </button>
        </div>

        <!-- Content Panels -->
        <div class="content-panels">
            <!-- TP1 - Clean -->
            <div class="panel active" id="panel-tp1">
                <div class="panel-header">
                    <div class="panel-title-group">
                        <h2 class="panel-title">Nettoyage & Préparation</h2>
                        <p class="panel-subtitle">Transformez vos données brutes en données exploitables</p>
                    </div>
                </div>

                <!-- Dataset Generation -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">1. Génération du Dataset</h3>
                        <div class="card-badge">Requis</div>
                    </div>
                    <div class="card-content">
                        <div class="form-group">
                            <label class="form-label">
                                <span>Seed (reproductibilité)</span>
                                <span class="label-hint">Même seed = même dataset</span>
                            </label>
                            <input type="number" id="tp1-seed" class="form-input" value="42" min="1">
                        </div>
                        <div class="form-group">
                            <label class="form-label">
                                <span>Nombre de lignes</span>
                            </label>
                            <input type="number" id="tp1-n" class="form-input" value="1000" min="10" max="10000">
                        </div>
                        <button class="btn btn-primary" onclick="generateDataset('clean')">
                            <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                <polyline points="7 10 12 15 17 10"/>
                                <line x1="12" y1="15" x2="12" y2="3"/>
                            </svg>
                            Générer Dataset
                        </button>
                    </div>
                    <div id="tp1-dataset-result" class="result-panel"></div>
                </div>

                <!-- Quality Report -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">2. Rapport Qualité (avant nettoyage)</h3>
                    </div>
                    <div class="card-content">
                        <button class="btn btn-secondary" onclick="getCleanReport()">
                            <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                <polyline points="14 2 14 8 20 8"/>
                            </svg>
                            Analyser la Qualité
                        </button>
                    </div>
                    <div id="tp1-report-result" class="result-panel"></div>
                </div>

                <!-- Cleaning Pipeline -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">3. Configuration du Nettoyage</h3>
                    </div>
                    <div class="card-content">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Stratégie d'imputation</label>
                                <select id="tp1-impute" class="form-select">
                                    <option value="mean">Moyenne (mean)</option>
                                    <option value="median">Médiane (median)</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Traitement des outliers</label>
                                <select id="tp1-outlier" class="form-select">
                                    <option value="clip">Clipper (clip)</option>
                                    <option value="remove">Supprimer (remove)</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Encodage catégoriel</label>
                                <select id="tp1-categorical" class="form-select">
                                    <option value="one_hot">One-Hot Encoding</option>
                                    <option value="ordinal">Ordinal Encoding</option>
                                </select>
                            </div>
                        </div>
                        <div class="button-group">
                            <button class="btn btn-primary" onclick="fitCleaner()">
                                <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="10"/>
                                    <polyline points="12 6 12 12 16 14"/>
                                </svg>
                                Apprendre le Pipeline
                            </button>
                            <button class="btn btn-success" onclick="transformData()" id="tp1-transform-btn" disabled>
                                <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="20 6 9 17 4 12"/>
                                </svg>
                                Appliquer le Nettoyage
                            </button>
                        </div>
                    </div>
                    <div id="tp1-clean-result" class="result-panel"></div>
                </div>
            </div>

            <!-- TP2 - EDA -->
            <div class="panel" id="panel-tp2">
                <div class="panel-header">
                    <div class="panel-title-group">
                        <h2 class="panel-title">Analyse Exploratoire (EDA)</h2>
                        <p class="panel-subtitle">Découvrez les patterns cachés dans vos données</p>
                    </div>
                </div>

                <!-- Dataset Generation -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">1. Génération du Dataset EDA</h3>
                    </div>
                    <div class="card-content">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Seed</label>
                                <input type="number" id="tp2-seed" class="form-input" value="123" min="1">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Nombre de lignes</label>
                                <input type="number" id="tp2-n" class="form-input" value="1000" min="10" max="10000">
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="generateDataset('eda')">Générer Dataset</button>
                    </div>
                    <div id="tp2-dataset-result" class="result-panel"></div>
                </div>

                <!-- Statistics -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">2. Statistiques Descriptives</h3>
                    </div>
                    <div class="card-content">
                        <button class="btn btn-secondary" onclick="getEdaSummary()">Calculer Statistiques</button>
                    </div>
                    <div id="tp2-summary-result" class="result-panel"></div>
                </div>

                <!-- Correlation -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">3. Matrice de Corrélation</h3>
                    </div>
                    <div class="card-content">
                        <button class="btn btn-secondary" onclick="getEdaCorrelation()">Calculer Corrélations</button>
                    </div>
                    <div id="tp2-corr-result" class="result-panel"></div>
                </div>

                <!-- Visualizations -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">4. Visualisations Interactives</h3>
                    </div>
                    <div class="card-content">
                        <button class="btn btn-primary" onclick="getEdaPlots()">
                            <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="12" y1="20" x2="12" y2="10"/>
                                <line x1="18" y1="20" x2="18" y2="4"/>
                                <line x1="6" y1="20" x2="6" y2="16"/>
                            </svg>
                            Générer Graphiques
                        </button>
                    </div>
                    <div id="tp2-plots-result" class="result-panel"></div>
                </div>
            </div>

            <!-- TP3 - Multivarié -->
            <div class="panel" id="panel-tp3">
                <div class="panel-header">
                    <div class="panel-title-group">
                        <h2 class="panel-title">Analyse Multivariée</h2>
                        <p class="panel-subtitle">PCA et Clustering pour réduire la dimensionnalité</p>
                    </div>
                </div>

                <!-- Dataset Generation -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">1. Génération du Dataset</h3>
                    </div>
                    <div class="card-content">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Seed</label>
                                <input type="number" id="tp3-seed" class="form-input" value="42" min="1">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Nombre de lignes</label>
                                <input type="number" id="tp3-n" class="form-input" value="1000" min="10" max="10000">
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="generateDataset('mv')">Générer Dataset</button>
                    </div>
                    <div id="tp3-dataset-result" class="result-panel"></div>
                </div>

                <!-- PCA -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">2. Analyse en Composantes Principales (PCA)</h3>
                    </div>
                    <div class="card-content">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Nombre de composantes</label>
                                <input type="number" id="tp3-pca-n" class="form-input" value="3" min="2" max="5">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Standardisation</label>
                                <select id="tp3-pca-scale" class="form-select">
                                    <option value="true">Oui (recommandé)</option>
                                    <option value="false">Non</option>
                                </select>
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="runPCA()">Exécuter PCA</button>
                    </div>
                    <div id="tp3-pca-result" class="result-panel"></div>
                </div>

                <!-- Clustering -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">3. Clustering K-Means</h3>
                    </div>
                    <div class="card-content">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Nombre de clusters (k)</label>
                                <input type="number" id="tp3-k" class="form-input" value="3" min="2" max="6">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Standardisation</label>
                                <select id="tp3-kmeans-scale" class="form-select">
                                    <option value="true">Oui (recommandé)</option>
                                    <option value="false">Non</option>
                                </select>
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="runKMeans()">Exécuter K-Means</button>
                    </div>
                    <div id="tp3-kmeans-result" class="result-panel"></div>
                </div>
            </div>

            <!-- TP4 - ML -->
            <div class="panel" id="panel-tp4">
                <div class="panel-header">
                    <div class="panel-title-group">
                        <h2 class="panel-title">Machine Learning Baseline</h2>
                        <p class="panel-subtitle">Entraînez vos premiers modèles prédictifs</p>
                    </div>
                </div>

                <!-- Dataset Generation -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">1. Génération du Dataset ML</h3>
                    </div>
                    <div class="card-content">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Seed</label>
                                <input type="number" id="tp4-seed" class="form-input" value="42" min="1">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Nombre de lignes</label>
                                <input type="number" id="tp4-n" class="form-input" value="1000" min="10" max="10000">
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="generateDataset('ml')">Générer Dataset</button>
                    </div>
                    <div id="tp4-dataset-result" class="result-panel"></div>
                </div>

                <!-- Model Training -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">2. Entraînement du Modèle</h3>
                    </div>
                    <div class="card-content">
                        <div class="form-group">
                            <label class="form-label">Type de modèle</label>
                            <select id="tp4-model-type" class="form-select">
                                <option value="logreg">Logistic Regression</option>
                                <option value="rf">Random Forest</option>
                            </select>
                        </div>
                        <button class="btn btn-primary" onclick="trainModel()">
                            <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="3"/>
                                <path d="M12 1v6m0 6v6m5.2-13.2l-4.2 4.2m0 6l4.2 4.2M23 12h-6m-6 0H1m18.8 5.2l-4.2-4.2m0-6l4.2-4.2"/>
                            </svg>
                            Entraîner le Modèle
                        </button>
                    </div>
                    <div id="tp4-train-result" class="result-panel"></div>
                </div>

                <!-- Predictions -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">3. Prédictions</h3>
                    </div>
                    <div class="card-content">
                        <p class="info-text">Entrez des valeurs pour prédire (format JSON)</p>
                        <textarea id="tp4-predict-data" class="form-textarea" rows="5" placeholder='[{"x1": 100, "x2": 50, "x3": 30, "x4": 20, "x5": 15, "x6": 10, "segment": "A"}]'></textarea>
                        <button class="btn btn-secondary" onclick="makePrediction()" id="tp4-predict-btn" disabled>Prédire</button>
                    </div>
                    <div id="tp4-predict-result" class="result-panel"></div>
                </div>
            </div>

            <!-- TP5 - ML Avancé -->
            <div class="panel" id="panel-tp5">
                <div class="panel-header">
                    <div class="panel-title-group">
                        <h2 class="panel-title">ML Avancé & Explicabilité</h2>
                        <p class="panel-subtitle">Optimisez et comprenez vos modèles</p>
                    </div>
                </div>

                <!-- Dataset Generation -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">1. Dataset (Réutiliser TP4 ou générer)</h3>
                    </div>
                    <div class="card-content">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Seed</label>
                                <input type="number" id="tp5-seed" class="form-input" value="42" min="1">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Nombre de lignes</label>
                                <input type="number" id="tp5-n" class="form-input" value="1000" min="10" max="10000">
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="generateDataset('ml2')">Générer Dataset</button>
                    </div>
                    <div id="tp5-dataset-result" class="result-panel"></div>
                </div>

                <!-- Hyperparameter Tuning -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">2. Optimisation des Hyperparamètres</h3>
                    </div>
                    <div class="card-content">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">Type de modèle</label>
                                <select id="tp5-model-type" class="form-select">
                                    <option value="logreg">Logistic Regression</option>
                                    <option value="rf">Random Forest</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Type de recherche</label>
                                <select id="tp5-search-type" class="form-select">
                                    <option value="grid">Grid Search</option>
                                    <option value="random">Random Search</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Cross-Validation (folds)</label>
                                <select id="tp5-cv" class="form-select">
                                    <option value="3">3 folds</option>
                                    <option value="5" selected>5 folds</option>
                                </select>
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="tuneModel()">
                            <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="3"/>
                                <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
                            </svg>
                            Lancer l'Optimisation
                        </button>
                    </div>
                    <div id="tp5-tune-result" class="result-panel"></div>
                </div>

                <!-- Feature Importance -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">3. Importance des Features</h3>
                    </div>
                    <div class="card-content">
                        <button class="btn btn-secondary" onclick="getFeatureImportance()" id="tp5-importance-btn" disabled>Calculer Importance</button>
                    </div>
                    <div id="tp5-importance-result" class="result-panel"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h4>DataFlow</h4>
                <p>Plateforme Data Science Interactive</p>
            </div>
            <div class="footer-section">
                <h4>Technologies</h4>
                <p>FastAPI • Python • Scikit-learn • Plotly</p>
            </div>
            <div class="footer-section">
                <h4>Documentation</h4>
                <a href="http://localhost:8000/docs" target="_blank">API Swagger</a>
            </div>
        </div>
    </footer>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loading-overlay">
        <div class="loading-spinner"></div>
        <p class="loading-text">Traitement en cours...</p>
    </div>

    <!-- Toast Notifications -->
    <div id="toast-container"></div>

    <script src="js/main.js"></script>
</body>
</html>
